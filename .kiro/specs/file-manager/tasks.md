# 实现计划

## 后端实现 (Spring Boot)

- [x] 1. 初始化 Spring Boot 项目结构
  - [x] 1.1 创建 Spring Boot 项目，配置 Maven/Gradle 依赖
    - 添加 spring-boot-starter-web、lombok、jqwik 等依赖
    - 配置 application.yml 基础设置
    - _需求: 1.1_
  - [x] 1.2 创建项目目录结构
    - 创建 controller、service、dto、util 包
    - _需求: 1.1_

- [x] 2. 实现数据传输对象 (DTO)



  - [x] 2.1 创建 FileNodeDTO 类


    - 包含 name、path、type、extension、size、children、lastModified 字段
    - _需求: 1.3, 2.3_
  - [x] 2.2 创建 FileContentDTO 类


    - 包含 path、content、encoding、mimeType 字段
    - _需求: 3.1, 3.2_
  - [x] 2.3 创建 ApiResponse 通用响应类


    - 包含 success、data、error、message 字段
    - _需求: 7.1, 7.2_

- [x] 3. 实现文件服务核心逻辑



  - [x] 3.1 实现 FileService 接口和实现类


    - 定义文件操作的核心方法签名
    - _需求: 1.1, 1.2_

  - [x] 3.2 实现目录树扫描功能

    - 递归读取目录结构
    - 识别文件类型和扩展名
    - _需求: 1.1, 1.2, 1.3_
  - [ ]* 3.3 编写属性测试：目录扫描完整性
    - **属性 1: 目录扫描完整性**
    - **验证: 需求 1.1, 1.2, 1.4**
  - [x] 3.4 实现文件类型识别工具类


    - 根据扩展名返回 MIME 类型
    - _需求: 1.3, 2.3_
  - [ ]* 3.5 编写属性测试：文件类型识别一致性
    - **属性 2: 文件类型识别一致性**
    - **验证: 需求 1.3**

  - [x] 3.6 实现文件节点排序功能
    - 目录优先，字母顺序排序
    - _需求: 2.4_
  - [ ]* 3.7 编写属性测试：排序规则一致性
    - **属性 3: 排序规则一致性**
    - **验证: 需求 2.4**

- [x] 4. 实现文件读写功能
  - [x] 4.1 实现文件内容读取功能
    - 支持多种编码格式
    - _需求: 3.1, 3.2, 6.1_
  - [x] 4.2 实现文件内容保存功能
    - 写入文件系统
    - _需求: 6.3_
  - [ ]* 4.3 编写属性测试：文件内容往返一致性
    - **属性 9: 文件内容往返一致性**
    - **验证: 需求 6.1, 6.3**

- [x] 5. 实现目录和文件创建功能
  - [x] 5.1 实现目录创建功能
    - 验证目录名有效性
    - 创建目录
    - _需求: 4.2, 4.3_
  - [ ]* 5.2 编写属性测试：目录创建有效性
    - **属性 5: 目录创建有效性**
    - **验证: 需求 4.2**
  - [ ]* 5.3 编写属性测试：无效目录名拒绝
    - **属性 6: 无效目录名拒绝**
    - **验证: 需求 4.3**
  - [x] 5.4 实现文件创建功能
    - 验证文件名有效性
    - 检查文件是否存在
    - 创建文件
    - _需求: 5.2, 5.3, 5.5_
  - [ ]* 5.5 编写属性测试：文件创建有效性
    - **属性 7: 文件创建有效性**
    - **验证: 需求 5.2**
  - [ ]* 5.6 编写属性测试：无效文件名拒绝
    - **属性 8: 无效文件名拒绝**
    - **验证: 需求 5.3**

- [x] 6. 实现安全验证
  - [x] 6.1 实现路径验证工具类
    - 检测路径遍历攻击
    - 验证路径合法性
    - _需求: 7.3, 7.4_
  - [ ]* 6.2 编写属性测试：特殊字符路径处理
    - **属性 10: 特殊字符路径处理**
    - **验证: 需求 7.3**
  - [ ]* 6.3 编写属性测试：路径遍历攻击防护
    - **属性 11: 路径遍历攻击防护**
    - **验证: 需求 7.4**

- [x] 7. 实现 REST API 控制器



  - [x] 7.1 创建 FileController


    - 实现 GET /api/files/tree 接口
    - 实现 GET /api/files/content 接口
    - 实现 POST /api/files/directory 接口
    - 实现 POST /api/files/file 接口
    - 实现 PUT /api/files/content 接口
    - 实现 GET /api/files/exists 接口
    - _需求: 1.1, 3.1, 4.2, 5.2, 6.3_
  - [x] 7.2 实现全局异常处理器


    - 统一错误响应格式
    - _需求: 7.1, 7.2_

  - [x] 7.3 配置 CORS 跨域支持

    - 允许前端访问
    - _需求: 1.1_

- [ ] 8. 检查点 - 确保后端所有测试通过
  - 确保所有测试通过，如有问题请询问用户。

## 前端实现 (Vue 3 + TypeScript)

- [x] 9. 初始化 Vue 项目结构



  - [x] 9.1 创建 Vue 3 + TypeScript + Vite 项目

    - 配置 TypeScript
    - 安装必要依赖（axios、fast-check、vitest 等）
    - _需求: 1.1_

  - [x] 9.2 创建项目目录结构

    - 创建 components、services、types、utils 目录
    - _需求: 1.1_


- [x] 10. 实现类型定义和 API 服务


  - [x] 10.1 创建 TypeScript 类型定义

    - FileNode、FileContent、ApiResponse 接口
    - _需求: 1.3, 2.3_

  - [x] 10.2 实现 API 服务类

    - 封装所有后端 API 调用
    - 统一错误处理
    - _需求: 1.1, 7.1_

- [x] 11. 实现工具函数



  - [x] 11.1 实现文件图标映射函数

    - 根据文件类型返回图标
    - _需求: 2.3_
  - [ ]* 11.2 编写属性测试：图标映射一致性
    - **属性 4: 图标映射一致性**
    - **验证: 需求 2.3**
  - [x] 11.3 实现文件节点排序函数


    - 目录优先，字母顺序
    - _需求: 2.4_

- [x] 12. 实现树形视图组件


  - [x] 12.1 创建 TreeNode 组件


    - 单个节点的渲染
    - 展开/折叠功能
    - _需求: 2.1, 2.2_

  - [x] 12.2 创建 TreeView 组件

    - 递归渲染目录树
    - 节点选择事件
    - _需求: 2.1, 2.2, 2.3, 2.4_
  - [ ]* 12.3 编写 TreeView 组件单元测试
    - 测试展开/折叠功能
    - 测试节点选择
    - _需求: 2.1, 2.2_


- [x] 13. 实现文件预览组件


  - [x] 13.1 创建 MarkdownPreview 组件

    - 渲染 Markdown 内容
    - _需求: 3.1_

  - [x] 13.2 创建 TextPreview 组件

    - 显示纯文本内容
    - _需求: 3.2_

  - [x] 13.3 创建 HtmlPreview 组件

    - 沙盒渲染 HTML
    - _需求: 3.3_
  - [x] 13.4 创建 PdfPreview 组件


    - 集成 PDF 查看器
    - _需求: 3.4_
  - [x] 13.5 创建 FilePreview 容器组件


    - 根据文件类型选择预览器
    - 处理不支持的文件类型
    - _需求: 3.1-3.7_

- [x] 14. 实现文件编辑器组件


  - [x] 14.1 创建 FileEditor 组件


    - 文本编辑功能
    - 未保存状态跟踪
    - 保存功能
    - _需求: 6.1, 6.2, 6.3, 6.4_
  - [ ]* 14.2 编写 FileEditor 组件单元测试
    - 测试内容加载
    - 测试保存功能
    - _需求: 6.1, 6.3_

- [x] 15. 实现创建对话框组件


  - [x] 15.1 创建 CreateDialog 组件


    - 输入验证
    - 创建目录/文件
    - _需求: 4.1, 4.3, 5.1, 5.3_


  - [x] 15.2 实现文件覆盖确认对话框
    - 检查文件是否存在
    - 确认覆盖
    - _需求: 5.5_

- [x] 16. 实现主应用组件
  - [x] 16.1 创建 App.vue 主布局
    - 集成树形视图、预览和编辑器
    - 状态管理
    - _需求: 1.1, 2.1_
  - [x] 16.2 实现未保存更改提示
    - 离开页面时提示
    - _需求: 6.6_
  - [x] 16.3 实现错误提示和成功通知

    - Toast 通知组件
    - _需求: 6.4, 6.5, 7.1, 7.2_

- [ ] 17. 最终检查点 - 确保所有测试通过
  - 确保所有测试通过，如有问题请询问用户。
